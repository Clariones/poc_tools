<?xml version="1.0" encoding="UTF-8"?>
<root xmlns:c="http://clariones.doublechaintech.com/uischema.xml" template="mobile">
	
	<!-- *************************** 用户、我的 ********************************* -->
	<!-- 我的 首页 -->
	<c:page name="customer-profile" title="我的">
		<c:data-source user="$(customer)" />
		<c:data-source platform="$(book_sharing_platform)" />

		<c:column class="padding--default align-center" link-to-url="/wxaService/viewCustomerProfile/">
			<c:row class="align-center">
				<c:image class="image-size-thumbnail round-image" src-url="$(user.logo_image)"></c:image>
			</c:row>
			<c:text class="text-title" data-source="$(user.nick_name)"></c:text>
			<c:row class="container--tag-mark">
				<c:text class="text-size-main" data-source="$(user.member_service.product_name)" />
				<c:date class="text-size-main padding--left-near" data-source="$(user.member_service_expire_date)" format=" 至MM.dd"/>
			</c:row>
			<!--  <c:money class="text-****-color-info" data-source="$(user.account_balance)" format="余额：￥#,##0.00#"></c:money> -->
		</c:column>
		<c:container class="container--empty"></c:container>
		
		<c:column class="padding--default">
			<c:text class="text-title">会员服务</c:text>
			<c:row class="padding--top-near scroll-x">
				<c:column class="padding--right-small" data-source="$(platform.member_service_product)"
					link-to-url="/wxaService/selectMemberService/$(id)/">
					<c:image class="image--size-list-thumbnail image--fill" src-url="$(product_cover_image)"></c:image>
					<c:text data-source="$(product_name)"></c:text>
				</c:column>
			</c:row>
		</c:column>
		<c:container class="container--empty"></c:container>

		<c:row name="item-list" class="list-as-grid-row each-row-3">
			<c:column class="grid-cell cell-default-border" link-to-url="/wxaService/customerMemberRights/">
				<c:row class="align-center">
					<c:image src-url="/images/rights.png"></c:image>
				</c:row>
				<c:text class="text-size-section-title text-color-main">我的权益</c:text>
			</c:column>
			<c:column class="grid-cell cell-default-border" link-to-url="/wxaService/customerBorrowHistory/">
				<c:row class="align-center">
					<c:image src-url="/images/books.png"></c:image>
				</c:row>
				<c:text class="text-size-section-title text-color-main">我的借阅</c:text>
			</c:column>
			<c:column class="grid-cell cell-default-border" link-to-url="/wxaService/customerCampaingList/">
				<c:row class="align-center">
					<c:image src-url="/images/campaign.png"></c:image>
				</c:row>
				<c:text class="text-size-section-title text-color-main">我的活动</c:text>
			</c:column>
			<c:column class="grid-cell cell-default-border" link-to-url="/wxaService/customerAccountDetail/">
				<c:row class="align-center">
					<c:image src-url="/images/wallet.png"></c:image>
				</c:row>
				<c:text class="text-size-section-title text-color-main">我的余额</c:text>
			</c:column>
			<c:column class="grid-cell cell-default-border" link-to-url="/wxaService/customerReviewList/">
				<c:row class="align-center">
					<c:image src-url="/images/myReview.png"></c:image>
				</c:row>
				<c:text class="text-size-section-title text-color-main">我的书评</c:text>
			</c:column>
			<c:column class="grid-cell cell-default-border" link-to-url="/wxaService/customerOrderList/needPay/">
				<c:row class="align-center">
					<c:image src-url="/images/order.png"></c:image>
				</c:row>
				<c:text class="text-size-section-title text-color-main">我的订单</c:text>
			</c:column>
		</c:row>
	</c:page>
	
	<!-- 我的：选择会员 -->
	<c:page name="select-member-service" title="选择会员">
		<c:data-source user="$(customer)"/>
		<c:data-source product="$(member_service_product)"/>
		<c:data-source info="$(member_rights_display)"/>
		
		<!-- 名称和图像 -->
		<c:column class="padding--far align-center">
			<c:text class="text-title" data-source="$(product.product_name)"></c:text>
		</c:column>
		<!-- 产品选择 -->
		<c:row name="sku-list" class="padding--far list-as-grid-row each-row-2">
			<c:row name="sku-card" class="grid-cell" data-source="$(product.member_service_bundle_sku)" target-id="$(id)">
				<c:column class="text--color-info member-service-sku-card">
					<c:row>
						<c:text class="text-title text--color-default" data-source="$(member_service_name)"></c:text>
					</c:row>
					<c:row>
						<c:text data-source="$(service_period_months)个月"></c:text>
					</c:row>
					<c:row>
						<c:money class="text--color-highlight text--size-middle text--strong padding--right-near" data-source="$(sale_price)"></c:money>
						<c:money class="text-list-price" data-source="$(list_price)"></c:money>
					</c:row>
				</c:column>
			</c:row>
			<c:row name="tailed-cell-1" class="grid-cell"/>
		</c:row>
		<c:form class="flex--1">
			<c:column class="flex--1">
				<c:column class="member-service-form-container">
					<c:field name="sku" type="radio" visible="false"/>
					<c:column name="need_mobile_number">
						<c:field name="mobile_number" type="vcode" label="手机号码"/>
						<c:field name="sms_code" type="text" min-value="6" max-value="8" label="短信验证码"/>
					</c:column>
				</c:column>
				
				<!-- 介绍 -->
				<c:container class="container--empty"></c:container>
				<c:row class="padding--far">
					<c:rich-text data-source="$(product.product_description)"></c:rich-text>
				</c:row>
				<c:container class="container--empty"></c:container>
				<!-- 权益展示 -->
				<c:row name="item-list" class="padding--far list-as-grid-row each-row-3">
					<c:column class="grid-cell cell-default-border text--color-info member-rights-card" data-source="$(info.member_rights_display_item)">
						<c:row class="align-center">
							<c:image src-url="$(image)" ></c:image>
						</c:row>
						<c:row class="fixed-height align-center">
							<c:text data-source="$(summary)"></c:text>
						</c:row>
					</c:column>
					<c:row name="tailed-cell-01" class="grid-cell"/>
					<c:row name="tailed-cell-02" class="grid-cell"/>
				</c:row>
		
			</c:column>
			
			<c:container class="container--bottom-space"/>
			<c:row class="buttons-row row-fixed-bottom">
				<c:action class="bottom-link-button" link-to-url="/wxaService/placeMemberServiceOrder/">
					<c:image src-url="/images/submit.png" />
					<c:text>确认购买</c:text>
				</c:action>
			</c:row>
		</c:form>
	</c:page>
    <!-- 我的： 权益 -->
	<c:page name="customer-member-rights" title="我的权益">
		<c:data-source info="$(member_rights_display)"/>
		<c:data-source product="$(member_service_product)"/>
		<!-- 名称和图像 -->
		<c:column class="padding--far align-center">
			<c:text class="text-title" data-source="$(info.name)"></c:text>
		</c:column>
		<c:container class="container--empty"></c:container>
		<!-- 介绍 -->
		<c:row class="padding--far">
			<c:rich-text data-source="$(info.summary)"></c:rich-text>
		</c:row>
		<c:container class="container--empty"></c:container>
		<!-- 权益展示 -->
		<c:row class="member_right_detail_block">
			<c:column class="member_right_item_name_column">
				<c:text class="content_text">name-1</c:text>
				<c:text class="content_text">name-2</c:text>
				<c:text class="content_text">name-3</c:text>
				<c:text class="content_text">name-4</c:text>
				<c:text class="content_text">name-5</c:text>
			</c:column>
			<c:column class="member_right_item_value_column">
				<c:text class="content_text" data-source="$(product.product_name)"/>
				<c:money class="content_text" data-source="$(product.overdue_pay)元/天"/>
				<c:text class="content_text" data-source="$(product.book_purchasing_discount_rate)折"/>
				<c:text class="content_text" data-source="$(product.book_borrowing_count)本"/>
				<c:money class="content_text" data-source="$(product.book_borrowing_limit_price)元"/>
				<c:text class="content_text" data-source="$(product.free_borrowing_days)天"/>
			</c:column>
		</c:row>
	</c:page>
	<!-- 我的 借阅 -->
	<c:page name="customer-borrow-list" title="我的借阅">
		<c:data-source user="$(customer)" />
		<c:column class="align-center empty-space-header-block">
			<c:text class="text-title"
				data-source="当前有$(user._by_key_inBorrwingCount)本在借图书">借书数量</c:text>
			<c:text class="text--color-info" data-source="可再借$(user._by_key_canBorrowCount)本" />
			<c:text name="reason" class="text--color-info" data-source="($(user._by_key_reason))" />
		</c:column>
		<c:container class="container--empty"></c:container>
		
		<c:column data-source="$(user.borrowing_history)" name="borrow-info">
			<c:row class="border--bottom padding--default" link-to-url="/wxaService/borrowingHistoryDetail/$(id)/">
				<c:image class="image-in-user-borrwing-history flex--0" src-url="$(book.book_cover)"></c:image>
				<c:column class="flex--1">
					<c:text class="text-title" format="10,...,5" data-source="$(book.book_name)"></c:text>
					<c:text class="text--color-info" data-source="$(book.book_author)" format="10,...,5" ></c:text>
					<c:date class="text--color-info" data-source="$(lending_datetime)" format="借书日期: yyyy.MM.dd"></c:date>
					<c:date class="text--color-info" data-source="$(free_lending_expired_datetime)"	format="免费期至: yyyy.MM.dd"></c:date>
					<c:date class="text--color-info"> </c:date>
					<c:text name="borrowing-status" class="pin-to-left-bottom" data-source="$(_by_key_status)">状态</c:text>
				</c:column>
			</c:row>
		</c:column>
		
		<c:column name="nothing" class="card">
			<c:text class="text-size-main text-color-marked-main">您还没有任何借阅记录。</c:text>
		</c:column>
	</c:page>
	<!-- 我的 借阅详情 -->
	<c:page name="customer-borrow-detail" title="借阅详情">
		<c:data-source record="$(borrowing_history)" />

		<c:toast name="messge" class="align-center" data-source="$(record._by_key_message)">
		</c:toast>
		<c:row class="padding--default" link-to-url="/wxaService/bookCopyDetail/$(record.book_copy.id)/">
			<c:column>
				<c:image class="image-in-user-borrwing-history" src-url="$(record.book.book_cover)">图书封面</c:image>
			</c:column>
			<c:column>
				<c:text class="text-title" data-source="$(record.book.book_name)">书名</c:text>
				<c:text class="text--color-info" data-source="$(record.book.book_recommend.name)">推荐类别</c:text>
			</c:column>
		</c:row>
		<c:container class="container--empty"></c:container>
		
		<c:row name="from-store-name" class="borrow-detail-row">
			<c:text>借书门店</c:text>
			<c:text data-source="$(record.lending_store.store_name)">店名</c:text>
		</c:row>
		<c:row name="borrow-time" class="borrow-detail-row">
			<c:text>借书日期</c:text>
			<c:date data-source="$(record.lending_datetime)" format="yyyy-MM-dd">借书日</c:date>
		</c:row>
		<c:column name="expire-date" class="borrow-detail-row">
			<c:row name="expire-date" class="align-both-ends">
				<c:text>免费阅读至</c:text>
				<c:date data-source="$(record.free_lending_expired_datetime)" format="yyyy-MM-dd">借书日</c:date>
			</c:row>
			<c:text name="expire-prompt" class="text--color-warning text--size-small"
					data-source="您借阅的《$(record.book.book_name)》已经超过免费阅读期了，请尽快到附近的门店归还。">逾期提醒</c:text>
		</c:column>
		<c:row name="return-store-name" class="borrow-detail-row">
			<c:text>还书门店</c:text>
			<c:text data-source="$(record.return_store.store_name)">店名</c:text>
		</c:row>
		<c:row name="return-time" class="borrow-detail-row">
			<c:text>还书日期</c:text>
			<c:date data-source="$(record.return_datetime)" format="yyyy-MM-dd">还书日</c:date>
		</c:row>
		<c:row name="expire-days" class="borrow-detail-row">
			<c:text>逾期天数</c:text>
			<c:text data-source="$(record._by_key_expiredDays)天"></c:text>
		</c:row>
		<c:row name="expire-fee" class="borrow-detail-row">
			<c:text>逾期费用</c:text>
			<c:money data-source="$(record._by_key_expireFee)" format="#,##0.##元"></c:money>
		</c:row>

		<c:row name="actions" class="fixed-at-bottom">
			<c:row name="pay" class="btn btn--green btn--full align-center" link-to-url="/wxaService/customerStartPayOrder/$(record._by_key_orderId)/">
				<c:font-icon>credit-card</c:font-icon>
				<c:text>支付</c:text>
			</c:row>
		</c:row>
	</c:page>
	<!-- 我的 余额总计和充值入口 -->
	<c:page name="customer-account-detail" title="我的余额">
		<c:data-source user="$(customer)" />
		<c:column class="flex--1">
			<c:column class="align-center">
				<c:text class="text-title">当前余额（元）</c:text>
				<c:money class="balance-money" data-source="$(user.account_balance)" format="#,##0.00"></c:money>
			</c:column>
			<c:container class="container--empty"></c:container>
			<c:row class="padding--default align-both-ends border--bottom" link-to-url="/wxaService/customerAccountHistory/">
				<c:text>明细</c:text>
				<c:font-icon>caret-right</c:font-icon>
			</c:row>
		</c:column>
		<c:container class="container--bottom-space"/>
    	<c:row class="buttons-row row-fixed-bottom">
			<c:button class="bottom-link-button" link-to-url="/wxaService/customerStartRecharge/">
				<c:image src-url="/images/recharge.png" />
				<c:text>充值</c:text>
			</c:button>
		</c:row>
		
	</c:page>
	
	<!-- 我的：我参与过的活动 -->
	<c:page name="customer-campaign-list" title="我的活动">
    	<c:data-source user="$(customer)"/>
		<c:column class="homepage-campaign-list">
			<c:row name="homepage-campaign-block" data-source="$(user.campaign_register_history)"
					 link-to-url="/wxaService/campaignDetail/$(campaign.id)/" class="homepage-campaign-block">
				<c:column class="campaign-image">
					<c:image class="image--fill" src-url="$(campaign.campaign_image)"></c:image>
				</c:column>
				<c:column class="list-item-right-block align-both-ends flex--1" name="campaign-info-block">
					<c:column>
						<c:text class="campaign-title" data-source="$(campaign.campaign_name)" format="8,...">标题</c:text>
						<c:row class="campaign-time" >
							<c:date name="campaign-hold-time" data-source="$(campaign.campaign_start_time)" format="yyyy-MM-dd HH:mm">时间</c:date>
							<c:text>~</c:text>
							<c:date name="campaign-finish-time" data-source="$(campaign.campaign_finish_time)" format="HH:mm">时间</c:date>
						</c:row>
						<c:text class="campaign-address" data-source="$(campaign.campaign_hold_address)" format="2,...,8">地点</c:text>
					</c:column>
					
					<c:row class="align-both-ends">
						<c:text name="register-info" class="reg-cnt" data-source="$(campaign._by_key_reg_cnt)/$(campaign.available_register_quantity)人" ></c:text>
						<c:text name="register-status" class="compaign-status" data-source="$(campaign._by_key_calculatedStatusName)">立即报名</c:text>
					</c:row>
				</c:column>
				<c:container class="container--empty"/>
			</c:row>
		</c:column>
		
    	<c:row name="nothing" class="padding--far">
    		<c:text class="text-title">您还没有参与过任何活动</c:text>
    	</c:row>
    </c:page>
    

	
	<!-- 我的 余额充值选择 -->
	<c:page name="customer-start-recharge" title="余额充值" class="full-height">
		<c:column class="default-list-item-card">
			<c:text class="title-text-size padding--bottom-far">选择充值金额</c:text>
			<c:row class="list-as-grid-row each-row-3 ">
				<c:row class="grid-cell" target-id="rc_10" active="true">
					<c:column class="recharge-card">
						<c:text class="text--size-big">10元</c:text>
						<c:text>充值10元</c:text>
					</c:column>
				</c:row>
				<c:row class="grid-cell" target-id="rc_20">
					<c:column class="recharge-card">
						<c:text class="text--size-big">20元</c:text>
						<c:text>充值20元</c:text>
					</c:column>
				</c:row>
				<c:row class="grid-cell" target-id="rc_50">
					<c:column class="recharge-card">
						<c:text class="text--size-big">50元</c:text>
						<c:text>充值50元</c:text>
					</c:column>
				</c:row>
				<c:row class="grid-cell" target-id="rc_100">
					<c:column class="recharge-card">
						<c:text class="text--size-big">100元</c:text>
						<c:text>充值100元</c:text>
					</c:column>
				</c:row>
				<c:row class="grid-cell" target-id="rc_200">
					<c:column class="recharge-card">
						<c:text class="text--size-big">200元</c:text>
						<c:text>充值200元</c:text>
					</c:column>
				</c:row>
				<c:row class="grid-cell" target-id="rc_500">
					<c:column class="recharge-card">
						<c:text class="text--size-big">500元</c:text>
						<c:text>充值500元</c:text>
					</c:column>
				</c:row>
				
			</c:row>
		</c:column>
		<c:container class="container--empty"/>
		
		<c:form class="stick-buttons-bottom">
			<c:column class="default-list-item-card flex--0">
				<c:field type="radio" visible="false" name="recharge_amount" content="10">
					<c:option id="rc_10" value="10" display-text="10元" checked="true" />
					<c:option id="rc_20" value="20" display-text="20元" />
					<c:option id="rc_30" value="30" display-text="30元" />
					<c:option id="rc_50" value="50" display-text="50元" />
					<c:option id="rc_100" value="100" display-text="100元" />
					<c:option id="rc_200" value="200" display-text="200元" />
					<c:option id="rc_500" value="500" display-text="500元" />
				</c:field>
	
				<c:field type="radio" name="payment_method" label="请选择支付方式" content="wechat">
					<c:option value="wechat" display-text="微信支付" checked="true"></c:option>
					<c:option value="agency" display-text="好友代付"></c:option>
				</c:field>
			</c:column>
			<c:row class="buttons-row flex--0 pin-to-bottom full-width">
				<c:button class="bottom-link-button" link-to-url="/wxaService/customerProfile/">
					<c:image src-url="/images/cancel.png" />
					<c:text>取消</c:text>
				</c:button>
				<c:container class="short-ver-line"/>
				<c:action class="bottom-link-button" name="submitRechargeForm" link-to-url="/wxaService/placeRechargeOrder/">
					<c:image src-url="/images/recharge.png" />
					<c:text>充值</c:text>
				</c:action>
			</c:row>
		</c:form>
	</c:page>
	<c:page name="customer-account-history" title="余额明细">
     	<c:data-source user="$(customer)"/>
     	
     	<c:text class="padding--default text-title">余额明细</c:text>
     	<c:container class="container--empty"></c:container>
     	<c:column>
     		<c:row class="padding--default border--bottom align-both-ends" data-source="$(user.customer_account_transaction)">
     			<c:column>
     				<c:text class="text-size-section-title" data-source="$(summary)"></c:text>
     				<c:date class="text-size-main text-color-note" data-source="$(change_datetime)" format="yyyy-MM-dd HH:mm:ss"></c:date>
     				<c:text class="text-size-main text-color-note" data-source="订单号:$(related_main_order.id)"></c:text>
     			</c:column>
     			<c:money class="text--color-highlight" name="ammount" data-source="$(amount)">金额</c:money>
     		</c:row>
     	</c:column>
     </c:page>
	<!-- 我的：查看个人信息 -->
	<c:page name="view-customer-profile" title="个人信息">
    	<c:data-source user="$(customer)"/>
    	<!-- <c:text class="padding-**-left-far text-**-color-info" data-source="用户 $(user.id)"/> -->
    	<c:column class="default-list-item-card align-center">
	    	<c:image class="image--size-thumbnail round-image" src-url="$(user.logo_image)"/>
	    	<c:text class="title-text-size" data-source="$(user.nick_name)" />
	    	<c:button type="getUserInfo" stat-in-page="true" 
	    		call-back-url="/wxaService/updateUserInfo/" class="btn btn--primary btn--half">使用微信头像</c:button>
    	</c:column>
    	<c:container class="container--empty"/>
    	
   		<c:row class="default-list-item-block text--color-info align-both-ends border--bottom">
   				<c:text>性别</c:text>
   				<c:text data-source="$(user.sexuality)">性别</c:text>
   		</c:row>
   		<c:row class="default-list-item-block text--color-info align-both-ends border--bottom">
   				<c:text>生日</c:text>
   				<c:date data-source="$(user.birthday)" format="yyyy年MM月dd日">生日</c:date>
   		</c:row>
   		<c:row class="default-list-item-block text--color-info align-both-ends border--bottom">
   				<c:text>真实姓名</c:text>
   				<c:text data-source="$(user.real_name)">真实姓名</c:text>
   		</c:row>
   		<c:row class="default-list-item-block text--color-info align-both-ends border--bottom">
   				<c:text>手机号码</c:text>
   				<c:text data-source="$(user.mobile_number)" format="3,******">手机号码</c:text>
   		</c:row>
   		<c:row class="default-list-item-block text--color-info align-both-ends border--bottom">
   				<c:text>身份证号码</c:text>
   				<c:text data-source="$(user.identity_card_number)" format="8,******">身份证号码</c:text>
   		</c:row>
   		<c:row class="default-list-item-block text--color-info align-both-ends border--bottom">
   				<c:text>家庭地址</c:text>
   				<c:text data-source="$(user.family_address)">家庭地址</c:text>
   		</c:row>
   		<c:container class="container--empty"/>
   		
   		<c:button name="submitForm" class="bottom-link-button" link-to-url="/wxaService/editCustomerProfile/">
  				<c:image src-url="/images/detail.png"/>
  				<c:text>更新个人信息</c:text>
   		</c:button>
    </c:page>
    <!-- 我的：编辑个人信息 -->
	<c:page name="edit-customer-profile" title="个人信息" >
    	<c:data-source user="$(customer)"/>
    	
    	<c:column class="edit-profile-header-block">
    		<c:row class="align-both-ends">
    			<c:text>头像</c:text>
    			<c:image class="image--size-thumbnail round-image" src-url="$(user.logo_image)"/>
    		</c:row>
    		<c:row class="align-both-ends">
    			<c:text>昵称</c:text>
    			<c:text data-source="$(user.nick_name)" />
    		</c:row>
    	</c:column>
    	<c:container class="container--empty"/>
    	
   			
   		<c:form class="flex--1">
   			<c:column class="edit-profile-form-fields-block flex--1">
   				<c:field label="性别" type="select" name="sexuality" placeholder="请选择"  data-source="$(user.sexuality)">
	   				<c:option value="男" display-text="男"/>
	   				<c:option value="女" display-text="女"/>
	   			</c:field>
	   			<c:field label="生日" type="date" name="birthday" 
	   				placeholder="请选择出生日期" 
	   				data-source="$(user.birthday)"/>
	   			<c:field label="真实姓名" type="text" name="real_name" 
	   				placeholder="请输入您的真实姓名" 
	   				data-source="$(user.real_name)" max-value="80"/>
	   			<c:field label="身份证号" type="text" name="identity_card_number" 
	   				placeholder="请输入您的身份证号"
	   				data-source="$(user.identity_card_number)" max-value="18"/>
	   			<c:field label="家庭地址" type="longtext" name="family_address" 
	   				placeholder="请输入您的家庭地址"
	   				data-source="$(user.family_address)" max-value="200"/>
   			</c:column>
   			<c:action name="submitForm" class="form-submit-button" link-to-url="/wxaService/updateCustomerProfile/">
   				<c:image src-url="/images/submit.png"/>
   				<c:text>提交</c:text>
    		</c:action>
   		</c:form>
    </c:page>
</root>
