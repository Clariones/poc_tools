<?xml version="1.0" encoding="UTF-8"?>
<root xmlns:c="http://clariones.doublechaintech.com/uischema.xml" template="mobile">
	
	<!-- *************************** 图书 ********************************* -->
	<!-- 图书详情 -->
	<c:page name="book-detail" title="书籍详情" front-color="#000000" background-color="#4BB86E">
		<c:data-source bookData="$(book)" />
		<c:data-source bookCopyData="$(book_copy)" />
		<c:data-source platform="$(book_sharing_platform)" />
		<c:data-source borrowRecord="$(borrowing_history)" />
		<c:data-source message="var: string" />

		<c:toast data-source="$(message)" />
		<!-- 图书封面图像 -->
		<c:row class="align-center background-green">
			<c:image class="image--size-main" src-url="$(bookData.book_cover)" />
		</c:row>
		<c:container class="container--empty"></c:container>
		<!-- 图书基本属性 -->
		<c:column name="book-info-block" class="padding--far">
			<c:text class="text-title text--align-center" data-source="$(bookData.book_name)">名称</c:text>
			<c:text class="text-color-info" data-source="作者:$(bookData.book_author)">作者</c:text>
			<c:text class="text-color-info" data-source="出版社:$(bookData.book_publisher)">出版社</c:text>
			<c:date class="text-color-info" data-source="$(bookData.book_pubdate)" format="出版时间:yyyy-MM">出版时间</c:date>
			<c:money class="text-color-info" data-source="$(bookData.list_price)" format="定价：￥#,##0.00">定价</c:money>
			<c:text class="text-color-info" data-source="ISBN: $(bookData.book_isbn13)">ISBN</c:text>
			<c:text name="isbn10" class="text-color-info" data-source="ISBN: $(bookData.book_isbn10)">ISBN</c:text>
		</c:column>
		<c:container class="container--empty"></c:container>
		<!-- 书内容 -->
		<c:column class="border--bottom padding--far">
			<c:row>
				<c:font-icon class="text-size-icon">book</c:font-icon>
				<c:text class="text-title padding--left-near">本书简介</c:text>
			</c:row>
			<c:text class="padding--top-near" data-source="$(bookData.book_summary)" max-line="8"></c:text>
		</c:column>
		<!-- 推荐 -->
		<c:column class="border--bottom padding--far">
			<c:row>
				<c:font-icon class="text-size-icon">bookmark</c:font-icon>
				<c:text class="text-title padding--left-near" data-source="$(bookData.book_recommend.name)">推荐</c:text>
			</c:row>
		</c:column>
		<!-- 馆藏列表 -->
		<c:column name="collection-info-title" class="border--bottom padding--far">
			<c:row>
				<c:font-icon class="text-size-icon">map-marker</c:font-icon>
				<c:text class="text-title padding--left-near">哪里可以借到？</c:text>
			</c:row>
			<c:row class="padding--top-near align-both-ends" data-source="$(platform.store)" link-to-url="/wxaService/selectStore/$(id)/">
				<c:text data-source="$(store_name)"></c:text>
				<c:text data-source="$(_by_key_count)本"></c:text>
			</c:row>
		</c:column>
		<!-- 最近借阅 -->
		<c:column name="recent-borrowers" class="padding--far">
			<c:row>
				<c:font-icon class="text-size-icon">group</c:font-icon>
				<c:text class="text-title padding--left-near">最近借阅</c:text>
			</c:row>
			<c:row class="padding--top-near" link-to-url="/wxaService/bookBorrowerList/$(bookData.id)/">
				<c:image class="image-icon" src-url="$(borrower.logo_image)"
					data-source="$(bookData.borrowing_history)" />
				<c:font-icon class="pin-to-right">ellipsis-h</c:font-icon>
			</c:row>
		</c:column>
		<c:container class="container--empty"></c:container>
		
		<!-- 书评列表 -->
		<c:column name="book-review-list" class="padding--far">
			<!-- 
			<c:row>
				<c:font-icon class="text-size-icon">comment-o</c:font-icon>
				<c:text class="text-title padding- -left-near">书评</c:text>
			</c:row>
			 -->
			<c:text class="text--size-big" data-source="评论 ($(bookData._by_key_reviewCount))"/>
		</c:column>
		<!-- 书评内容 -->
		<c:column data-source="$(bookData.book_review)" class="card small-bottom-space">
			<c:row class="align-both-ends">
				<c:row class="no-flex-weight">
					<c:image class="image-size-icon" src-url="$(reviewer.logo_image)" />
					<c:column class="no-flex-weight">
						<c:text class="text-size-main text-color-marked-main" data-source="$(reviewer.nick_name)">名字</c:text>
						<c:date name="post-time" class="text-size-note" data-source="$(review_publish_datetime)"
							format="1_hour_or_earlier">
							时间
						</c:date>
					</c:column>
				</c:row>
				<c:row class="no-flex-weight">
					<c:row class="no-flex-weight" stat-in-page="true"
						link-to-url="/wxaService/praiseBookReview/book/$(bookData.id)/$(id)/$(_by_key_thumbUp)/">
						<c:font-icon name="thumbUp" class="text-size-note">heart-o</c:font-icon>
						<c:text name="praise-count" class="text-size-note" data-source="$(_by_key_praiseCount)">100
						</c:text>
					</c:row>
					<c:ugc-control class="text-size-main text-color-main normal-left-space"
						link-to-url="/wxaService/ugcContentControl/$(id)/book/" title-block="屏蔽" title-report="举报">
						...
					</c:ugc-control>
				</c:row>
			</c:row>
			<c:text max-line="8" class="text-size-main small-space" data-source="$(review_content)" />
		</c:column>

		<c:row>
			<c:button name="review"
				link-to-url="/wxaService/postBookReviewPage/$(bookData.id)/$(borrowRecord.book_copy.id)/">发表评论</c:button>
			<c:button name="borrow" link-to-url="/wxaService/customerBorrowBook/$(bookCopyData.id)/">借书</c:button>
		</c:row>
	</c:page>
	
	<!-- 图书：最近借阅人列表 -->
	<c:page name="book-borrowers-list" title="最近借阅">
		<c:data-source bookData="$(book)" />

		<c:row class="card normal-bottom-space" link-to-url="/wxaService/bookDetailPage/$(bookData.id)/">
			<c:image class="image-size-thumbnail" src-url="$(bookData.book_cover)" />
			<c:column>
				<c:text class="text-size-section-title text-color-marked-main" data-source="$(bookData.book_name)" />
				<c:text class="text-size-main" data-source="$(bookData.book_recommend.name)" />
			</c:column>
		</c:row>

		<c:row class="flat-bar list-as-grid-row each-row-5">
			<c:column class="list-as-grid-row-item " data-source="$(bookData.borrowing_history)">
				<c:image src-url="$(borrower.logo_image)" class="image-size-icon" />
			</c:column>
			<c:column class="list-as-grid-row-item" data-source="$(bookData.borrowing_history)">
				<c:image src-url="$(borrower.logo_image)" class="image-size-icon" />
			</c:column>
			<c:column class="list-as-grid-row-item" data-source="$(bookData.borrowing_history)">
				<c:image src-url="$(borrower.logo_image)" class="image-size-icon" />
			</c:column>
		</c:row>
	</c:page>

	<!-- 借书成功 -->
	<c:page name="borrow-book-success" title="借书">
		<c:data-source borrowRecord="$(borrowing_history)"/>
		<c:data-source alreadyBorrowed="var: int"/>
		<c:data-source stillCanBorrow="var: int"/>
		
		<c:row class="empty-space-header-block align-center">
			<c:font-icon class="font-icon--big-flag">check-circle-o</c:font-icon>
			<c:column>
				<c:text class="text-title">借书成功</c:text>
				<c:text class="text--color-info" data-source="已借$(alreadyBorrowed)本，还可以借$(stillCanBorrow)本"/>
			</c:column>
		</c:row>
		<c:container class="container--empty"/>
		
		<c:row class="padding--far">
			<c:image class="image--size-thumbnail" src-url="$(borrowRecord.book.book_cover)"/>
			<c:column>
				<c:text class="text-title" data-source="$(borrowRecord.book.book_name)"></c:text>
				<c:text class="text--color-info" data-source="$(borrowRecord.book.book_recommend.name)" />
				<c:text class="padding--far"></c:text>
				<c:date class="text--color-info" data-source="$(borrowRecord.lending_datetime)" format="借阅日期： yyyy.MM.dd"/>
				<c:date class="text--color-info" data-source="$(borrowRecord.free_lending_expired_datetime)" format="截止日期： yyyy.MM.dd"/>
			</c:column>
		</c:row>
		
		<c:row class="row-of-button-line fixed-at-bottom">
			<c:row class="btn btn--in-same-line">
				<c:column class="align-center">
					<c:font-icon>book</c:font-icon>
				</c:column>
				<c:column class="align-center">
				<c:button  link-to-url="/wxaService/borrowingHistoryDetail/$(borrowRecord.id)/">
					查看详情
				</c:button>
				</c:column>
			</c:row>
			<c:row name="register-campaign" class="btn btn--in-same-line">
				<c:column class="align-center">
				<c:font-icon>spinner fa-spin</c:font-icon>
				</c:column>
				<c:column class="align-center">
				<c:button link-to-url="/wxaService/wantBorrowBook/scanCode/">
					继续借阅
				</c:button>
				</c:column>
			</c:row>
		</c:row>
	</c:page>
</root>
